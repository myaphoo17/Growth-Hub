<app-loading></app-loading>
<div *ngIf="showToast" class="toast-notification">
  {{ toastMessage }}
</div>

<div class="profile-container mt-3">
  <div class="personal-details card">
    <img src="{{instructorData.profilePhotoUrl}}" alt="Profile Picture" class="profile-picture">
    <h2>{{instructorData.name}}</h2>
    <button class="btn secondary" (click)="openModal('updateProfilePhotoModal')">Update profile photo</button>
    <!-- <button class="btn bg-blue-900">Share profile link</button> -->
  </div>

  <div class="additional-info card">
    <h3>Education</h3>
    <ng-container *ngFor="let edu of educations">
      <div class="education-entry">
        <div class="education-details">
          <p><mat-icon>school</mat-icon>{{ edu.degree }} at {{ edu.institution }}</p>
          <p>{{ edu.startDate }} - {{ edu.graduationDate }}</p>
        </div>
        <div class="education-actions">
          <button mat-button (click)="getEducationById(edu.id)">
            <mat-icon aria-hidden="false" aria-label="edit icon" class="text-sm">edit</mat-icon>
          </button>
          <button mat-button (click)="deleteEducationById(edu.id)">
            <mat-icon aria-hidden="false" aria-label="delete icon" class="text-sm">delete</mat-icon>
          </button>
        </div>
      </div>
    </ng-container>
    <button class="btn" (click)="openModal('addEducationModal')">Add Education</button>
  </div>

  <div class="additional-info card">
    <h3>Other info</h3>
    <p><mat-icon aria-hidden="false" aria-label="post icon" class="text-sm">person_apron</mat-icon>{{ instructorData.staffId }}</p>
    <p><mat-icon aria-hidden="false" aria-label="post icon" class="text-sm">mail</mat-icon>{{ instructorData.email }}</p>
    <p><mat-icon aria-hidden="false" aria-label="post icon" class="text-sm">badge</mat-icon>{{ instructorData.department }}</p>
    <p><mat-icon aria-hidden="false" aria-label="post icon" class="text-sm">vpn_key</mat-icon>{{ instructorData.doorLogNo }}</p>
    <p><mat-icon aria-hidden="false" aria-label="post icon" class="text-sm">work</mat-icon>{{ instructorData.role }}</p>
    <button class="btn bg-blue-900" (click)="openModal('updateProfileInfoModal')">Update your Info</button>
  </div>
</div>
<div *ngIf="instructorData.role == 'Instructor'">
<h2 class="popular-course-header bg-blue-900 text-white">Created Courses</h2>
<app-mycourse></app-mycourse>
</div>

<!-- Add Education Modal -->
<div id="addEducationModal" class="modal">
  <div class="modal-content">
    <span class="close" (click)="closeModal('addEducationModal')">&times;</span>
    <div class="modal-header">Add Education</div>
    <form class="modal-form" (ngSubmit)="addEducation()">
      <label for="degree">Degree:</label>
      <input type="text" id="degree" [(ngModel)]="newEducation.degree" name="degree" required>

      <label for="institution">Institution:</label>
      <input type="text" id="institution" [(ngModel)]="newEducation.institution" name="institution" required>

      <label for="startDate">Start Date:</label>
      <input type="date" id="startDate" [(ngModel)]="newEducation.startDate" name="startDate" required>

      <label for="graduationDate">Graduation Date:</label>
      <input type="date" id="graduationDate" [(ngModel)]="newEducation.graduationDate" name="graduationDate" required>

      <button class="btn primary" type="submit">Add Education</button>
    </form>
  </div>
</div>

<!-- Edit Education Modal -->
<div id="editEducationModal" class="modal">
  <div class="modal-content">
    <span class="close" (click)="closeModal('editEducationModal')">&times;</span>
    <div class="modal-header">Edit Education</div>
    <form class="modal-form" (ngSubmit)="saveEditedEducation()">
      <label for="editDegree">Degree:</label>
      <input type="text" id="editDegree" [(ngModel)]="editedEducation.degree" name="degree" required>
      <input type="hidden" [(ngModel)]="editedEducation.id">
      <label for="editInstitution">Institution:</label>
      <input type="text" id="editInstitution" [(ngModel)]="editedEducation.institution" name="institution" required>

      <label for="editStartDate">Start Date:</label>
      <input type="date" id="editStartDate" [(ngModel)]="editedEducation.startDate" name="startDate" required>

      <label for="editGraduationDate">Graduation Date:</label>
      <input type="date" id="editGraduationDate" [(ngModel)]="editedEducation.graduationDate" name="graduationDate" required>

      <button class="btn primary" type="submit">Save Education</button>
    </form>
  </div>
</div>

<!-- Update Profile Info Modal -->
<div id="updateProfileInfoModal" class="modal">
  <div class="modal-content">
    <span class="close" (click)="closeModal('updateProfileInfoModal')">&times;</span>
    <div class="modal-header bg-blue-900">Update Information</div>
    <form class="modal-form" (ngSubmit)="updateProfileInfo()">
      <label for="email">Email:</label>
      <input type="email" id="email" [(ngModel)]="instructorData.email" name="email" required>
      <button class="btn bg-blue-900" type="submit">Save</button>
    </form>
  </div>
</div>

<!-- Update Profile Photo Modal -->
<div id="updateProfilePhotoModal" class="modal">
  <div class="modal-content">
    <span class="close" (click)="closeModal('updateProfilePhotoModal')">&times;</span>
    <div class="modal-header">Update Profile Photo</div>
    <form class="modal-form">
      <label for="profilePhoto">Select a profile photo:</label>
      <input type="file" id="profilePhoto" (change)="onFileSelected($event)">
      <button class="btn primary" (click)="updateProfilePhoto()">Upload Photo</button>
    </form>
  </div>
</div>
<!-- Toast Notification -->
<div *ngIf="showToast" class="toast-notification" [ngClass]="toastType">
  <span class="icon">
    <!-- Optional icon based on toastType -->
    <mat-icon *ngIf="toastType === 'success'">check_circle</mat-icon>
    <mat-icon *ngIf="toastType === 'error'">error</mat-icon>
    <mat-icon *ngIf="toastType === 'info'">info</mat-icon>
    <mat-icon *ngIf="toastType === 'warning'">warning</mat-icon>
  </span>
  <span class="message">{{ toastMessage }}</span>
  <button class="close-btn" (click)="showToast = false">&times;</button>
</div>
